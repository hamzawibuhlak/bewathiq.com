# Phase 32: Call Center WebRTC + WhatsApp QR Integration

## 1. Database Schema
- [ ] Add `SipExtension` model
- [ ] Add `WhatsappSession` model  
- [ ] Add `WhatsappMessage` model
- [ ] Add enums: `WhatsappStatus`, `MessageDirection`, `MessageStatus`
- [ ] Add relations to [Tenant](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/frontend/src/types/index.ts#41-52), [User](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/frontend/src/stores/auth.store.ts#5-22), [Client](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/frontend/src/types/index.ts#83-102)

## 2. Backend — Call Center Module
- [ ] `sip-extension.service.ts`
- [ ] `call-record.service.ts`
- [ ] `call-center.controller.ts`
- [ ] `call-center.module.ts`

## 3. Backend — WhatsApp Baileys
- [ ] `whatsapp-baileys.service.ts`
- [ ] Update [whatsapp.controller.ts](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/backend/src/whatsapp/whatsapp.controller.ts) with QR endpoints
- [ ] Update [whatsapp.module.ts](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/backend/src/whatsapp/whatsapp.module.ts)
- [ ] Update [websocket.gateway.ts](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/backend/src/websocket/websocket.gateway.ts) with WA broadcast methods

## 4. Backend — App Module + Dependencies
- [ ] Install `@whiskeysockets/baileys`, `@hapi/boom`
- [ ] Register `CallCenterModule` in [app.module.ts](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/backend/src/app.module.ts)

## 5. Frontend — Softphone
- [ ] `api/callCenter.ts`
- [ ] `hooks/useSoftphone.ts`
- [ ] `components/call-center/Softphone.tsx`

## 6. Frontend — WhatsApp QR
- [ ] `api/whatsappQr.ts`
- [ ] `components/whatsapp/WhatsappConnect.tsx`
- [ ] Update [hooks/use-websocket.ts](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/frontend/src/hooks/use-websocket.ts) with QR hooks
- [ ] Install `jssip`, `@types/jssip`
