# Phase 23: Accounting & Finance Module

Ù†Ø¸Ø§Ù… Ù…Ø­Ø§Ø³Ø¨Ø© Ù…ØªÙƒØ§Ù…Ù„ Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© (SOCPA) Ù…Ø¹ Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ Ùˆ 3 Ù‚ÙˆØ§Ø¦Ù… Ù…Ø§Ù„ÙŠØ©.

> [!IMPORTANT]
> Ù‡Ø°Ø§ Phase Ø¶Ø®Ù… (~16,000 Ø³Ø·Ø±). Ø³Ø£Ù†ÙØ°Ù‡ Ø¹Ù„Ù‰ **Ù…Ø±Ø§Ø­Ù„ Ù…ØªØªØ§Ù„ÙŠØ©** - ÙƒÙ„ Ù…Ø±Ø­Ù„Ø© ØªÙØ¨Ù†Ù‰ ÙˆØªÙØ®ØªØ¨Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØªØ§Ù„ÙŠØ©.

## Proposed Changes

### Database Schema
#### [MODIFY] [schema.prisma](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/backend/prisma/schema.prisma)
- Ø¥Ø¶Ø§ÙØ© ~15 model Ø¬Ø¯ÙŠØ¯: `Account`, `JournalEntry`, `JournalEntryLine`, `AccountsReceivable`, `ARPayment`, `AccountsPayable`, `APPayment`, `Vendor`, `Expense`, `ExpenseCategory`, `BankAccount`, `BankTransaction`, `BankReconciliation`, `CostCenter`, `Budget`, `FiscalYear`
- Ø¥Ø¶Ø§ÙØ© ~10 enums: `AccountType`, `AccountCategory`, `JournalEntryType`, `JournalEntryStatus`, `ARStatus`, `APStatus`, `ExpenseStatus`, `PaymentMethod`, `ReconciliationStatus`, `BudgetPeriod`, `BudgetStatus`
- ØªØ­Ø¯ÙŠØ« [Tenant](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/backend/src/cache/cache.service.ts#132-138), [User](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/WatheeqMobile/src/api/auth.ts#13-23), [Invoice](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/backend/src/email/email.service.ts#238-262) relations

---

### Backend Services
#### [NEW] accounting/account.service.ts
- CRUD Ù„Ù„Ø­Ø³Ø§Ø¨Ø§Øª + seeder Ù„Ù€ 50+ Ø­Ø³Ø§Ø¨ Ø§ÙØªØ±Ø§Ø¶ÙŠ

#### [NEW] accounting/journal-entry.service.ts
- Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ØŒ validation (Debit=Credit)ØŒ ØªØ±Ø­ÙŠÙ„ØŒ Ø¹ÙƒØ³ØŒ Ù‚ÙŠÙˆØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠØ©

#### [NEW] accounting/financial-statements.service.ts
- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„ØŒ Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ©ØŒ Ø§Ù„ØªØ¯ÙÙ‚Ø§Øª Ø§Ù„Ù†Ù‚Ø¯ÙŠØ©ØŒ Ø§Ù„Ù†Ø³Ø¨ Ø§Ù„Ù…Ø§Ù„ÙŠØ©

#### [NEW] accounting/ar.service.ts
- Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© + ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø¹Ù…Ø§Ø± (Aging)

#### [NEW] accounting/ap.service.ts
- Ø§Ù„Ø°Ù…Ù… Ø§Ù„Ø¯Ø§Ø¦Ù†Ø© + Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ÙˆØ±Ø¯ÙŠÙ†

#### [NEW] accounting/expense.service.ts
- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª Ù…Ø¹ workflow Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©

#### [NEW] accounting/bank.service.ts
- Ø§Ù„ØªØ³ÙˆÙŠØ© Ø§Ù„Ø¨Ù†ÙƒÙŠØ©

#### [NEW] accounting/budget.service.ts
- Ø§Ù„Ù…ÙˆØ§Ø²Ù†Ø© + Ù…Ø±Ø§ÙƒØ² Ø§Ù„ØªÙƒÙ„ÙØ©

#### [NEW] accounting/accounting.controller.ts
- ~40 API endpoint

#### [NEW] accounting/accounting.module.ts

---

### Frontend
#### [NEW] pages/accounting/AccountingDashboardPage.tsx
- KPIs + charts + quick access

#### [NEW] pages/accounting/ChartOfAccountsPage.tsx
- Ø¹Ø±Ø¶ Ø´Ø¬Ø±ÙŠ Ù„Ù„Ø­Ø³Ø§Ø¨Ø§Øª

#### [NEW] pages/accounting/JournalEntriesPage.tsx
- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚ÙŠÙˆØ¯ + Ø¥Ù†Ø´Ø§Ø¡ Ù‚ÙŠØ¯ ÙŠØ¯ÙˆÙŠ

#### [NEW] pages/accounting/FinancialStatementsPage.tsx
- 3 Ù‚ÙˆØ§Ø¦Ù… Ù…Ø§Ù„ÙŠØ© + export

#### [MODIFY] [App.tsx](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/frontend/src/App.tsx)
- Ø¥Ø¶Ø§ÙØ© routes Ù„Ù„Ù…Ø­Ø§Ø³Ø¨Ø©

#### [MODIFY] [Sidebar.tsx](file:///Users/hamzabuhlakq/Downloads/succes-mark/projects-2026/wathiq%20system%20projec/watheeq-mvp/frontend/src/components/layout/Sidebar.tsx)
- Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù… "Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©" ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©

---

## Execution Strategy

Ø³Ø£Ø¨Ø¯Ø£ Ø¨Ù€ **Part A** (Database + Core Services) ÙˆØ£Ø¨Ù†ÙŠ Ø¹Ù„ÙŠÙ‡ ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹:

| Ø§Ù„Ù…Ø±Ø­Ù„Ø© | Ø§Ù„Ù…Ø­ØªÙˆÙ‰ | Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© |
|---------|---------|----------|
| Part A | Schema + Migration + Account Service + Journal Entries | ğŸ”´ Ø£Ø³Ø§Ø³ÙŠ |
| Part B | AR/AP + Expenses | ğŸŸ¡ Ù…Ù‡Ù… |
| Part C | Financial Statements + VAT | ğŸŸ¡ Ù…Ù‡Ù… |
| Part D | Bank + Cost Centers + Budgets | ğŸŸ¢ Ø¥Ø¶Ø§ÙÙŠ |
| Part E | Controller + API | ğŸ”´ Ø£Ø³Ø§Ø³ÙŠ |
| Part F | Frontend Pages | ğŸ”´ Ø£Ø³Ø§Ø³ÙŠ |
| Part G | Deploy | ğŸ”´ Ø£Ø³Ø§Ø³ÙŠ |

## Verification Plan

### Automated Tests
- `npm run build` Ø¨Ø¹Ø¯ ÙƒÙ„ Ù…Ø±Ø­Ù„Ø©
- `npx prisma migrate dev` Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Schema

### Manual Verification
- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬ Ù…ØªÙˆØ§Ø²Ù† (Debit = Credit)
- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø¹Ù…ÙˆÙ…ÙŠØ© (Assets = Liabilities + Equity)
- ÙØ­Øµ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø­Ù„ÙŠ ÙˆØ§Ù„Ø¥Ù†ØªØ§Ø¬ÙŠ
